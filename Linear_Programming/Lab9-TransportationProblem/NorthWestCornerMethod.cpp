/*
    ---------------------------
    Name    - Devjit Choudhury
    Roll No - 19MA20014
    ---------------------------
    TRANSPORTATION PROBLEM
    ---------------------------
    North West Corner Method
*/

/*
    LOGIC :- North West corner method
    -------
    1. Check if transportation table is balanced
        ie. Total supply = Total Demand

    eg.
        d1  d2  d3  d4  |
    s1  19  30  50  10  |   7
                        |
    s2  70  30  40  60  |   9
                        |
    s3  40  8   70  20  |   18
    ---------------------
        5   8   7   14      <34>

    Ttotal supply = Total demand = 34

    2. Find min of supply and demand (row value and col value)
    Whenever sources or destintions have 0 avaibility cancel the corresponding row or column
    
-------------------------------------
        d1  d2  d3  d4  |
    s1  <5> 30  50  10  |   2
                        |
    s2  -   30  40  60  |   9
                        |
    s3  -   8   70  20  |   18
    ---------------------
        0   8   7   14      
-------------------------------------
        d1  d2  d3  d4  |
    s1  <5> <2> -   -   |   0
                        |
    s2  -   30  40  60  |   9
                        |
    s3  -   8   70  20  |   18
    ---------------------
        0   6   7   14      
-------------------------------------
        d1  d2  d3  d4  |
    s1  <5> <2> -   -   |   0
                        |
    s2  -   <6> 40  60  |   3
                        |
    s3  -   -   70  20  |   18
    ---------------------
        0   0   7   14      
-------------------------------------
        d1  d2  d3  d4  |
    s1  <5> <2> -   -   |   0
                        |
    s2  -   <6> <3> -   |   0
                        |
    s3  -   -   70  20  |   18
    ---------------------
        0   0   4   14      
-------------------------------------
        d1  d2  d3  d4  |
    s1  <5> <2> -   -   |   0
                        |
    s2  -   <6> <3> -   |   0
                        |
    s3  -   -   <4> 20  |   14
    ---------------------
        0   0   0   14      
-------------------------------------
        d1  d2  d3  d4  |
    s1  <5> <2> -   -   |   0
                        |
    s2  -   <6> <3> -   |   0
                        |
    s3  -   -   <4> <14>|   0
    ---------------------
        0   0   0   0
-------------------------------------
    

    In this method :-
    We go from the North West row to the bottom right row

    Check out input and output of the given question at bottom

*/

#include <bits/stdc++.h>
using namespace std;

int n, m;
double costArray[100][100];
double supply[100];
double demand[100];

////////////////////////////////////////////////////////////////////////////////////////////////////////
// Function To Display the Table for Transportation Problem
void display(double A[][100], double B[], double C[]) {
    cout<<left<<setw(10)<<""<<" | ";
    for(int j=1;j<=m;j++){
        cout<<left<<setw(10)<<"D["+to_string(j)+"]"<<" | ";
    }
    cout<<endl;
    cout<<"__________________________________________________________________"<<endl;
    for(int i=1; i<=n; i++){
        cout<<left<<setw(10)<<"s["+to_string(i)+"]"<<" | ";
        for(int j=1; j<=m; j++){
            cout<<left<<setw(10)<<A[i][j]<<" | ";
        }
        cout<<left<<setw(10)<<B[i]<<endl;
    }
    cout<<"__________________________________________________________________"<<endl;
    
    cout<<left<<setw(10)<<""<<" | ";
    for(int j=1; j<=m; j++){
        cout<<left<<setw(10)<<C[j]<<" | ";
    }
    cout<<endl;
}


/////////////////////////////////////////////////////////////////////////////////////////////////////////
// To check if the given Transportation Problem is Balanced or Not
// Balanced Transportation Problem => ( Total Supply = Total Demand )
bool checkIfBalanced(double S[], double D[]){
    double totalSupply = 0;
    double totalDemand = 0;
    for(int i=1; i<=n; i++){
        totalSupply += S[i];
    }
    for(int j=1; j<=m; j++){
        totalDemand += D[j];
    }
    if(abs(totalDemand - totalSupply) <= 0.001){
        return true;
    }else{
        return false;
    }
}



int main(){
    // ------------------------------------------------------------
    // Taking the input
    cout<<"Enter number of Supply Sources : ";
    cin>>n;
    cout<<"Enter number of Destinaton Demands : ";
    cin>>m;

    cout<<"Enter the Cost Values :-"<<endl;
    for(int i=1; i<=n; i++){
        for(int j=1; j<=m; j++){
            cout<<"Source : S["<<i<<"] -> Destination : D["<<j<<"] : ";
            cin>>costArray[i][j];
        }
    }

    cout<<"Enter Values of Supply from :- "<<endl;
    for(int i=1; i<=n; i++) {
        cout<<"Source ["<<i<<"] : ";
        cin>>supply[i];
    }

    cout<<"Enter Value of Demand for :- "<<endl;
    for(int j=1; j<=m; j++) {
        cout<<"Destination ["<<j<<"] : ";
        cin>>demand[j];
    }

    // ------------------------------------------------------------
    // Displaying the Initial Transportation Table
    cout<<"--------------------------------------------------------------------------------------------------------"<<endl;
    cout<<"--------------------------------------------------------------------------------------------------------"<<endl;
    cout<<"--------------------------------------------------------------------------------------------------------"<<endl;
    cout<<"The Initial Transportation Table :-"<<endl;
    display(costArray, supply, demand);
    cout<<"--------------------------------------------------------------------------------------------------------"<<endl;
    cout<<"--------------------------------------------------------------------------------------------------------"<<endl;
    cout<<"--------------------------------------------------------------------------------------------------------"<<endl;
    // ------------------------------------------------------------
    // Chekcking if the problem is Balanced
    bool isBalanced = checkIfBalanced(supply, demand);

    // If not balanced -> display message and Exit
    if(!isBalanced) {
        cout<<"The given Transportation problem is not balanced"<<endl;
        return 0;
    }

    // ------------------------------------------------------------
    // creating a copy of CostArray, supply, demand
    // CostArrayCopy -> will contain Number of Unots for each source to Destination
    double costArrayCopy[100][100], supplyCopy[100], demandCopy[100];
    bool occupied[100][100];
    for(int i=1; i<=n; i++){
        for(int j=1; j<=m; j++){
            costArrayCopy[i][j] = costArray[i][j];
            occupied[i][j] = false;
        }
    }
    for(int i=1; i<=n; i++){
        supplyCopy[i] = supply[i];
    }
    for(int j=1; j<=m; j++){
        demandCopy[j] = demand[j];
    }

    // ------------------------------------------------------------
    // Iterating to get solution - Check out the LOGIC commented Above
    int iterationCount = 1;
    pair<int, int> pos = {1,1};
    while(iterationCount <= n+m-1){
        occupied[pos.first][pos.second]  =  true;
        if( supplyCopy[pos.first] <= demandCopy[pos.second] ){
            costArrayCopy[pos.first][pos.second] = supplyCopy[pos.first];
            for(int j=1; j<=m; j++){
                if(j==pos.second){
                    continue;
                }else{
                    if(occupied[pos.first][j] == true){
                        continue;
                    }else{
                        // occupied[pos.first][j] = true;
                        costArrayCopy[pos.first][j] = 0;
                    }
                }
            }
            demandCopy[pos.second] -= supplyCopy[pos.first];
            supplyCopy[pos.first] = 0;
            if(pos.first+1 > n){
                break;
            }
            pos = {pos.first+1, pos.second};
        }else{
            costArrayCopy[pos.first][pos.second] = demandCopy[pos.second];
            for(int i=1; i<=n; i++){
                if(i==pos.first){
                    continue;
                }else{
                    if(occupied[i][pos.second] == true){
                        continue;
                    }else{
                        // occupied[i][pos.second] = true;
                        costArrayCopy[i][pos.second] = 0;
                    }
                }
            }
            supplyCopy[pos.first] -= demandCopy[pos.second];
            demandCopy[pos.second] = 0;
            if(pos.second+1 > m){
                break;
            }
            pos = {pos.first, pos.second+1};            
        }

        cout<<"--------------------------------------------------------------------------------------------------------"<<endl;
        cout<<"--------------------------------------------------------------------------------------------------------"<<endl;
        cout<<"--------------------------------------------------------------------------------------------------------"<<endl;
        cout<<"Transportation Table after Interation Number : "<<iterationCount<<endl;
        display(costArrayCopy, supplyCopy, demandCopy);
        cout<<"--------------------------------------------------------------------------------------------------------"<<endl;
        cout<<"--------------------------------------------------------------------------------------------------------"<<endl;
        cout<<"--------------------------------------------------------------------------------------------------------"<<endl;
        iterationCount++;
    }
    cout<<"--------------------------------------------------------------------------------------------------------"<<endl;
    cout<<"--------------------------------------------------------------------------------------------------------"<<endl;
    cout<<"--------------------------------------------------------------------------------------------------------"<<endl;
    cout<<"Transportation Table after Interation Number : "<<iterationCount<<endl;
    display(costArrayCopy, supplyCopy, demandCopy);
    cout<<"--------------------------------------------------------------------------------------------------------"<<endl;
    cout<<"--------------------------------------------------------------------------------------------------------"<<endl;
    cout<<"--------------------------------------------------------------------------------------------------------"<<endl;


    cout<<"----------------------------------------------------------"<<endl;
    cout<<"Basic Feasible Solution :- "<<endl;
    double totalCost = 0;
    for(int i=1; i<=n; i++){
        for(int j=1; j<=m; j++){
            if(costArrayCopy[i][j] > 0){
                cout<<"S["<<i<<"] -> D["<<j<<"] = "<<costArrayCopy[i][j]<<endl;
                totalCost = totalCost + costArrayCopy[i][j] * costArray[i][j];
            }
        }
    }
    cout<<"----------------------------------------------------------"<<endl;
    cout<<"Transportation Cost :- "<<endl;
    cout<<totalCost<<endl;
    cout<<"----------------------------------------------------------"<<endl;
}


/*
Input 1 -
3 4
2 3 5 1
7 3 4 6
4 1 7 2
8 10 20
6 8 9 15

Output 1 -
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
The Initial Transportation Table :-
           | D[1]       | D[2]       | D[3]       | D[4]       |
__________________________________________________________________
s[1]       | 2          | 3          | 5          | 1          | 8
s[2]       | 7          | 3          | 4          | 6          | 10
s[3]       | 4          | 1          | 7          | 2          | 20
__________________________________________________________________
           | 6          | 8          | 9          | 15         |
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
Transportation Table after Interation Number : 1
           | D[1]       | D[2]       | D[3]       | D[4]       |
__________________________________________________________________
s[1]       | 6          | 3          | 5          | 1          | 2
s[2]       | 0          | 3          | 4          | 6          | 10
s[3]       | 0          | 1          | 7          | 2          | 20
__________________________________________________________________
           | 0          | 8          | 9          | 15         |
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
Transportation Table after Interation Number : 2
           | D[1]       | D[2]       | D[3]       | D[4]       |
__________________________________________________________________
s[1]       | 6          | 2          | 0          | 0          | 0
s[2]       | 0          | 3          | 4          | 6          | 10
s[3]       | 0          | 1          | 7          | 2          | 20
__________________________________________________________________
           | 0          | 6          | 9          | 15         |
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
Transportation Table after Interation Number : 3
           | D[1]       | D[2]       | D[3]       | D[4]       |
__________________________________________________________________
s[1]       | 6          | 2          | 0          | 0          | 0
s[2]       | 0          | 6          | 4          | 6          | 4
s[3]       | 0          | 0          | 7          | 2          | 20
__________________________________________________________________
           | 0          | 0          | 9          | 15         |
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
Transportation Table after Interation Number : 4
           | D[1]       | D[2]       | D[3]       | D[4]       |
__________________________________________________________________
s[1]       | 6          | 2          | 0          | 0          | 0
s[2]       | 0          | 6          | 4          | 0          | 0
s[3]       | 0          | 0          | 7          | 2          | 20
__________________________________________________________________
           | 0          | 0          | 5          | 15         |
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
Transportation Table after Interation Number : 5
           | D[1]       | D[2]       | D[3]       | D[4]       |
__________________________________________________________________
s[1]       | 6          | 2          | 0          | 0          | 0
s[2]       | 0          | 6          | 4          | 0          | 0
s[3]       | 0          | 0          | 5          | 2          | 15
__________________________________________________________________
           | 0          | 0          | 0          | 15         |
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
Transportation Table after Interation Number : 6
           | D[1]       | D[2]       | D[3]       | D[4]       | 
__________________________________________________________________
s[1]       | 6          | 2          | 0          | 0          | 0
s[2]       | 0          | 6          | 4          | 0          | 0
s[3]       | 0          | 0          | 5          | 15         | 0
__________________________________________________________________
           | 0          | 0          | 0          | 0          | 
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
----------------------------------------------------------
Basic Feasible Solution :-
S[1] -> D[1] = 6
S[1] -> D[2] = 2
S[2] -> D[2] = 6
S[2] -> D[3] = 4
S[3] -> D[3] = 5
S[3] -> D[4] = 15
----------------------------------------------------------
Transportation Cost :-
117
----------------------------------------------------------
*/

/*
Input 2 -
3 4
19 30 50 10
70 30 40 60
40 8 70 20
7 9 18
5 8 7 14

Output 2 -
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
The Initial Transportation Table :-
           | D[1]       | D[2]       | D[3]       | D[4]       |
__________________________________________________________________
s[1]       | 19         | 30         | 50         | 10         | 7
s[2]       | 70         | 30         | 40         | 60         | 9
s[3]       | 40         | 8          | 70         | 20         | 18
__________________________________________________________________
           | 5          | 8          | 7          | 14         |
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
Transportation Table after Interation Number : 1
           | D[1]       | D[2]       | D[3]       | D[4]       |
__________________________________________________________________
s[1]       | 5          | 30         | 50         | 10         | 2
s[2]       | 0          | 30         | 40         | 60         | 9
s[3]       | 0          | 8          | 70         | 20         | 18
__________________________________________________________________
           | 0          | 8          | 7          | 14         |
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
Transportation Table after Interation Number : 2
           | D[1]       | D[2]       | D[3]       | D[4]       |
__________________________________________________________________
s[1]       | 5          | 2          | 0          | 0          | 0
s[2]       | 0          | 30         | 40         | 60         | 9
s[3]       | 0          | 8          | 70         | 20         | 18
__________________________________________________________________
           | 0          | 6          | 7          | 14         |
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
Transportation Table after Interation Number : 3
           | D[1]       | D[2]       | D[3]       | D[4]       |
__________________________________________________________________
s[1]       | 5          | 2          | 0          | 0          | 0
s[2]       | 0          | 6          | 40         | 60         | 3
s[3]       | 0          | 0          | 70         | 20         | 18
__________________________________________________________________
           | 0          | 0          | 7          | 14         | 
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
Transportation Table after Interation Number : 4
           | D[1]       | D[2]       | D[3]       | D[4]       |
__________________________________________________________________
s[1]       | 5          | 2          | 0          | 0          | 0
s[2]       | 0          | 6          | 3          | 0          | 0
s[3]       | 0          | 0          | 70         | 20         | 18
__________________________________________________________________
           | 0          | 0          | 4          | 14         | 
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
Transportation Table after Interation Number : 5
           | D[1]       | D[2]       | D[3]       | D[4]       |
__________________________________________________________________
s[1]       | 5          | 2          | 0          | 0          | 0
s[2]       | 0          | 6          | 3          | 0          | 0
s[3]       | 0          | 0          | 4          | 20         | 14
__________________________________________________________________
           | 0          | 0          | 0          | 14         |
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
Transportation Table after Interation Number : 6
           | D[1]       | D[2]       | D[3]       | D[4]       |
__________________________________________________________________
s[1]       | 5          | 2          | 0          | 0          | 0
s[2]       | 0          | 6          | 3          | 0          | 0
s[3]       | 0          | 0          | 4          | 14         | 0
__________________________________________________________________
           | 0          | 0          | 0          | 0          |
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
----------------------------------------------------------
Basic Feasible Solution :-
S[1] -> D[1] = 5
S[1] -> D[2] = 2
S[2] -> D[2] = 6
S[2] -> D[3] = 3
S[3] -> D[3] = 4
S[3] -> D[4] = 14
----------------------------------------------------------
Transportation Cost :-
1015
----------------------------------------------------------
*/